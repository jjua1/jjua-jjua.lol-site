<!DOCTYPE html>
<html>
<head>
  <title>쭈아 내전시트</title>
  <style>
    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 20px;
    }
    th, td {
      border: 1px solid black;
      padding: 8px;
      text-align: left;
    }
    th {
      background-color: #f2f2f2; /* 표 맨윗줄 배경색!*/
    }
    .container {  /*배경 여백*/

            border: 2px solid white;
            margin: 20px;
            padding: 20px;
            background: white ;
        }
    #admin { /*admin은 맨 윗줄 쭈아 내전시트*/
            background: #e5aaa3;
            padding: 10px; 
        }

        #admin ul {
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center; /*가운데 정렬!*/
        }

        #admin ul li {
            list-style-type: none; 
            padding: 0 15px; 
        }

        #admin ul li a {
            font-size: 30px; /* 메인 폰트 크기  */
            color: white;
            text-decoration: none;
        }
    tbody tr:nth-child(even) {/*짝수 줄 마다 색 변경!!*/
            background: solid black;
        }
    
     tbody tr:hover { /*마우스 가져다 되었을때 효과 주는것!!*/
            background: pink;
        }
        .search-box { /*검색창*/
      margin-bottom: 20px;
      text-align: center;
    }
    .search-box input {
      padding: 8px;
      font-size: 16px;
      width: 50%;
      max-width: 400px;
    }
  </style>
</head>
<body><nav id="admin">
        <ul>
            <li><a href="#">쭈아 내전시트</a></li>
        </ul>
    </nav>
  <div class="container">

    
  <h2>통계</h2>
         <div class="search-box">
           
      <input type="text" id="statsSearch" placeholder="통계 검색..." onkeyup="filterTable('statsTable', 'statsSearch')">
    </div>
    
  <table id="statsTable"></table>
    

    
  <h2>챔피언통계</h2>
        <div class="search-box">
          
      <input type="text" id="championSearch" placeholder="챔피언 통계 검색..." onkeyup="filterTable('championTable', 'championSearch')">
    </div>
    
  <table id="championTable"></table>
    
  <script>
    function createTable(data, tableId) {
      var table = document.getElementById(tableId);
      table.innerHTML = "";  // 기존 테이블 내용 지우기
      var thead = table.createTHead();
      var tbody = table.createTBody();
      var merges = data.merges;
      var formats = data.formats;

      // 테이블 헤더 생성
      var headerRow = thead.insertRow();
      data.data[0].forEach(function(header) {
        var th = document.createElement("th");
        th.appendChild(document.createTextNode(header));
        headerRow.appendChild(th);
      });

      // 테이블 데이터 생성
      for (var i = 1; i < data.data.length; i++) {
        var row = tbody.insertRow();
        for (var j = 0; j < data.data[i].length; j++) {
          if (!isMergedCell(i + 1, j + 1, merges)) {
            var cell = row.insertCell();
            var mergeInfo = getMergeInfo(i + 1, j + 1, merges);
            if (mergeInfo) {
              cell.rowSpan = mergeInfo.rowSpan;
              cell.colSpan = mergeInfo.colSpan;
            }
            // % 형식 적용
            if (formats[i][j] === "0.00%" && i >= 2) {
              cell.appendChild(document.createTextNode((data.data[i][j] * 100).toFixed(2) + "%"));
            } else {
              cell.appendChild(document.createTextNode(data.data[i][j]));
            }
          }
        }
      }
    }

    function isMergedCell(row, col, merges) {
      for (var k = 0; k < merges.length; k++) {
        var merge = merges[k];
        if (row >= merge.row && row < merge.row + merge.numRows &&
            col >= merge.column && col < merge.column + merge.numColumns) {
          return true;
        }
      }
      return false;
    }

    function getMergeInfo(row, col, merges) {
      for (var k = 0; k < merges.length; k++) {
        var merge = merges[k];
        if (row == merge.row && col == merge.column) {
          return { rowSpan: merge.numRows, colSpan: merge.numColumns };
        }
      }
      return null;
    }

    function loadData() {
      // 통계 데이터 불러오기
      fetch('stats.json')
        .then(response => response.json())
        .then(data => createTable(data, 'statsTable'))
        .catch(error => console.error('Error loading stats data:', error));

      // 챔피언통계 데이터 불러오기
      fetch('champion.json')
        .then(response => response.json())
        .then(data => createTable(data, 'championTable'))
        .catch(error => console.error('Error loading champion data:', error));
    }

    function filterTable(tableId, searchId) {
      var input = document.getElementById(searchId);
      var filter = input.value.toLowerCase();
      var table = document.getElementById(tableId);
      var rows = table.getElementsByTagName("tr");

      // 테이블의 모든 행을 순차적으로 확인
      for (var i = 1; i < rows.length; i++) {
        var cells = rows[i].getElementsByTagName("td");
        var match = false;

        // 각 셀의 내용을 확인
        for (var j = 0; j < cells.length; j++) {
          if (cells[j]) {
            var cellText = cells[j].textContent || cells[j].innerText;
            if (cellText.toLowerCase().indexOf(filter) > -1) {
              match = true;
              break; // 검색어와 일치하는 셀이 있으면 해당 행을 보이게 함
            }
          }
        }

        // 일치하는 셀이 있으면 행을 표시하고, 없으면 숨김
        if (match) {
          rows[i].style.display = "";
        } else {
          rows[i].style.display = "none";
        }
      }
    }
    window.onload = loadData;  // 페이지 로드 시 데이터 불러오기
  </script>
</body>
</html>
